# eventually adjust this rule when having trouble with false positives with WebServices that allow full blown XML content to be submitted
description=potential XSS (script injection) - via cookie
servletPath=.
cookie@prefilter=[CDATA [DATA action ActiveXObject alert applet area background base behavior bgsound binding blockquote body captureEvents class cookie createAttribute createElement createTextNode div document embed entity escape eval execScript expression form frame fromCharCode getElement href html http-equiv image img import input layer link map meta Microsoft msgbox namespace object onabort onbeforeunload onblur onchange onclick ondblclick ondragdrop onerror onfocus onkeydown onkeypress onkeyup onload onmouse onmove onreset onresize onselect onsubmit onunload option parent reload replace schemas-microsoft-com script source span src style table this top url void window write xml XMLHTTP XMLHttpRequest xss
cookie=(?s)(?i)(?:<|&lt;?|%3C|\u00BC|&#0*+60;?|&#x0*+3c;?|\\\\(?:x|u00)3c)(?:script|body|html|table|xss|style|bgsound|object|embed|applet|i?frame|form|input|option|blockquote|area|map|link|base|layer|div|span|img|meta)|on(?:abort|blur|change|click|dblclick|dragdrop|error|focus|keydown|keypress|keyup|load|mousedown|mousemove|mouseout|mouseover|mouseup|move|reset|resize|select|submit|(?:before)?unload)\\s*+=|\\.cookie|(?:execScript|escape|alert|msgbox|eval|expression)\\s*+\\(|(?:^|\\s+|\\.)(?:this|top|parent|document)\\.[a-zA-Z0-9_%]+|(?:java|vb)script\\s*+:|(?:dyn|low)src|void\\s*+\\(0\\)|http-equiv|text/(?:x-)?scriptlet|fromCharCode|\\.\\s*+href\\s*+=|getElements?By(?:Tag)?(?:Name|Id)\\s*+\\(|\\.\\s*+captureEvents\\s*+\\(|\\.\\s*+create(?:Attribute|Element|TextNode)\\s*+\\(|\\.\\s*+write(?:ln)?\\s*+\\(|\\.\\s*+re(?:place|load)?\\s*+\\(|(?:style|class)\\s*+=|(?:href|src|source|action)\\s*+=\\s*+["']|@import|(?:behavior|image|binding)\\s*+:\\s*+url\\s*+\\(|background\\s*+=\\s*+['"]|AllowScriptAccess\\s*+=|image/svg\\+xml|(?:<|&lt;?|%3C|\u00BC|&#0*+60;?|&#x0*+3c;?|\\\\(?:x|u00)3c)(?:\\?|!)\\s*+(?:import|entity|xml)|!\\[CDATA|DATA(?:SRC|FLD|FORMATAS)\\s*+=|Set-?Cookie|new\\s+(ActiveXObject|XMLHttpRequest)\\s*+\\(|schemas-microsoft-com|:namespace|Microsoft\\.XMLHTTP|window\\s*+.\\s*+open\\s*+\\(|\\.\\s*+action\\s*+=|;\\s*+url\\s*+=|res://ieframe\\.dll
